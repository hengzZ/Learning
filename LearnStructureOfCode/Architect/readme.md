## 软件架构学习笔记

### “架构” 的概念是什么？

###### 需求分析的目标和最终结果，都是要最终形成清晰的产品定义。产品定义将明确产品的元素，明确产品的边界，与产业上下游、合作伙伴的分工。

* **首先，在需求分析阶段，我们关注用户需求的精确表述。我们会引入角色，也就是系统的各类参与方，以及角色间的交互方式，也就是“用户故事”。**

* **然后，在概要设计阶段，我们一般以子系统为维度来阐述系统各个角色之间的关系。但是，对于关键的子系统，我们还会进一步分解它，甚至详细到把该子系统的所有模块的职责和接口都确定下来。**
  ###### 概要设计阶段的衡量准则：如果某个子系统不做进一步的分解也不会在项目上有什么风险，那么我们并不需要在这个阶段对其细化。（风险最小准则）

  ###### 补充说明：
    * 虽然涉及到模块和接口定义，但核心意图并不是确定系统完整的模块列表，我们的焦点是整个系统如何被有效地串联起来。
    * 为了降低风险，概要设计阶段也应该有代码产出。

  ###### 出发点:
    * 这样做的好处是，一上来我们就关注了全局系统性风险的消除；
    * 并且给了每个子系统或模块的负责人一个更具象且确定性的认知。

* **最后，在详细设计阶段，是需要各个子系统或模块的负责人，对他负责的部分进行进一步的细化。**
  ###### 请记住，详细设计并不是只谈实现就完事，更不是一个架构图。

  ###### 详细设计阶段的考核点：
    * 现状与需求。（各技术分析调研） 现在在哪里，遇到了什么问题，要做何改进。
    * 需求满足方式。（交付验收标准）
        1. 要做成啥样？ 交付物的规格，或者说使用界面（接口）。
        1. 怎么做到？ 交付物的实现原理，完成交付的同时要考虑延续性。

#### 概要设计和详细设计的工作内容会有一定的重叠
* 概要设计的核心目标是串联整个系统，消除系统的重大风险。在这个过程中，对一些关键模块的实现细节有所考虑是非常正常的。

* 从另一个角度来说，分解粒度也不能过粗，不应该把特别庞大的子系统直接分出去，这样项目执行的风险就太高了。

<br>

### 事务与工程
如果我们停留在事务中不能出来，那么随着我们所服务的用户数量增加，必然需要大量的人员来应对繁重的事务工作。

事务工作是低风险低压力的劳动，事务性的工作并不会总是让人不开心，特别是工作不太多的时候。

###### 同时，我们也必须清楚，一定数量的事务工作是不可避免的，这是任何工程类工作都具有的特点。 （如何算事务数量占比较高，要看个人自己的决定。）

###### 如果花在工程项目上的时间太少，你的职业发展会变慢。 （什么是工程？ 本质上，工程师文化也是产品文化。）

<br>

### 启发

##### 1. 风险面
* 系统性风险的考虑
* 执行风险的考虑

系统性风险和执行风险都应由架构师考虑，并在架构时考虑。

##### 2. 分工面
* 需求分析
* 概要设计
* 详细设计

##### 3. 报告面
* 陈述
    ###### 陈述是对痛点和改进方向的一次共识确认。
    准则：简明扼要 —— 痛点只要够痛，大家都知道，是不需要长篇累牍的。 （区分真假痛点的好准则）

##### 4. 成果面
* 逻辑自洽
* 完备性 （即完整度）

##### 5. 执行面
* 交付。（高 KPI 吻合度） 交付物的规格，或者说使用界面（接口）要达标。体现的是别人要怎么使用对接产品。
* 执行。（执行者该考虑的延续性） 在需求分析、概要设计、详细设计等过程之间也要有自然的延续性。

<br>

### 再谈数据结构
—— “存储即数据结构”

数据结构从大的层面分，可分为基于内存的数据结构，和基于外存（比如 SSD 盘）的数据结构。

尤其对于服务端程序在数据结构这一点上，最为重要的一件事是选择合适的存储中间件。

##### 1. 从外存的数据结构看
在服务端我们谈数据结构，谈的不是内存数据结构，往往谈的是数据库的表结构设计。

虽然现在的数据库多样化，出于惯例我们往往还是以 “定义表结构” 一词来描述。

##### 描述表结构，核心需要包含以下内容：
* 字段名；
* 类型；
* 字段含义，以及是否指向另一个表的某个字段；
* 索引。

###### 你会发现，其实定义表结构和定义内存数据结构本质是完全一致的。

##### 2. 再看内存的数据结构
定义内存中的一个类（或结构体），我们也关心字段名（成员变量名）和类型，也关心字段的含义，以及它是否指向另一个类（或结构体）的某个字段（成员变量）。

* 字段名；
* 类型；
* 字段含义，以及以及是否指向另一个表的某个字段；（指针？or not）

但内存数据结构没有 “索引（SELECT）” 的概念。

##### 3. 总结
以后定义或考虑数据结构，都应以 “定义表结构” 的思路来分析考虑。

<br>

### 再谈算法
程序 = 数据结构 + 算法”

##### 1. 什么是算法？
算法是一系列解决问题的明确指令。

##### 2. 算法的陈述准则
* 算法的每一个步骤都必须没有歧义。 （明确且可执行）
* 算法所处理的输入具有明确的值域规定。 （严格定义的输入内容）

<br>

###### reference
极客时间 《许式伟的架构课》
